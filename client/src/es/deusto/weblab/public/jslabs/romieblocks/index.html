<!DOCTYPE html>
<html lang="es">
<head>
	<title>Romie Blockly</title>
	<meta charset="UTF-8">

	<link rel="stylesheet" href="bower_components/bootstrap/dist/css/bootstrap.min.css">

	<script src="bower_components/jquery/dist/jquery.min.js"></script>
	<script src="../../jslib/weblabjs.js"></script>
	<script src="bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
	<script src="bower_components/google-blockly/blockly_compressed.js"></script>
	<script src="bower_components/google-blockly/javascript_compressed.js"></script>
	<script src="bower_components/google-blockly/blocks_compressed.js"></script>
	<script src="bower_components/google-blockly/msg/js/es.js"></script>
	<script src="bower_components/js-interpreter/acorn_interpreter.js"></script>
	<script>
		$(parent.document).find('iframe[name=wlframe]').hide();

		start = function() {
			$(parent.document).find('iframe[name=wlframe]').show();
		}

		Weblab.setOnStartInteractionCallback(start);
	</script>
</head>
<body>

<div class="container">
	<p class="tooltip" style="text-align: center;">Aquí tienes un editor de código visual. Ahora puedes programar el robot y decidir qué hará en el laberinto. Cuando hayas acabado, reserva el robot para poder ver </p>

	<button class="col-md-2 col-md-offset-5" onclick="test();">Probar</button>

	<div class="row">
		<div id="blocklyDiv" class="col-md-6" style="margin-top: 4em; height: 480px;"></div>

		<div class="col-md-5 col-md-offset-1">
			<h3>Código</h3>
			<textarea id="textarea" style="width: 100%; height: 480px;"></textarea>
		</div>
	</div>
</div>

	<xml id="toolbox" style="display: none">
		<block type="controls_if"></block>
		<block type="logic_compare"></block>
		<block type="controls_repeat_ext"></block>
		<block type="math_number"></block>
<!-- 		<block type="move_forward"></block>
		<block type="move_left"></block>
		<block type="move_right"></block>
		<block type="check_wall"></block> -->
	</xml>

	<script>
		var workspace = Blockly.inject('blocklyDiv',
			{media: 'bower_components/google-blockly/media/',
			toolbox: document.getElementById('toolbox')});

		function myUpdateFunction() {
			document.getElementById('textarea').value = Blockly.JavaScript.workspaceToCode(workspace);
		}
		workspace.addChangeListener(myUpdateFunction);

		function test() {
			function nextStep() {
			if (myInterpreter.step()) {
					window.setTimeout(nextStep, 10);
				}
			}
			nextStep();
		}
	</script>
</body>
</html>
